{% load custom_tags %}


<h2>ã‚»ãƒƒã‚·ãƒ§ãƒ³çµæœ - {{ session.title }}</h2>
<p>å‡ºé¡Œå…ƒã®æœ¬: {{ session.book.title }}</p>
<p>ä½œæˆè€…: {{ session.host.username }}</p>

<table border="1" cellpadding="8" cellspacing="0">
  <thead>
    <tr>
      <th>#</th>
      <th>æ—¥æœ¬èª</th>
      <th>æ­£è§£</th>
      {% for user in participants %}
        <th>{{ user.username }}ã®å›ç­”</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for row in rows %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ row.japanese }}</td>
        <td>{{ row.english }}</td>
        {% for a in row.answers %}
          <td style="
            {% if a.is_correct %}
              background-color: #d2f4dc;
            {% else %}
              {% if a.gpt_says_correct %}
                background-color: #b6faaf;
              {% else %}
                background-color: #f8d7da;
              {% endif %}
            {% endif %}
          ">
            {{ a.text }}
          </td>
        {% endfor %}
      </tr>
    {% endfor %}

    <!-- åˆè¨ˆè¡Œ -->
    <tr>
      <td colspan="3"><strong>æ­£ç­”æ•°</strong></td>
      {% for user in participants %}
        <td style="text-align: center;">
          {{ user_scores|get_item:user.username }}/{{ total_questions }}
          {% if user.username in top_users %} ğŸ‘‘{% endif %}
        </td>
      {% endfor %}
    </tr>
  </tbody>
</table>

<p><a href="{% url 'home' %}">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a></p>
